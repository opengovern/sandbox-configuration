ID: aws_route53_domain_not_expired
Title: Route 53 domains should not be expired
Description: This control identifes any expired domain names registered with AWS Route 53. When the expired domain names are not restored promptly, they will become available for others to register. Restoring on time your Route 53 expired domains will allow you to reestablish full control over their registration.
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: |
        select
          arn as resource,
          case
            when expiration_date < (current_date - interval '1' minute) then 'alarm'
            else 'ok'
          end as status,
          case
            when expiration_date < (current_date - interval '1' minute) then title || ' expired on ' || to_char(expiration_date, 'DD-Mon-YYYY') || '.'
            else title || ' set to expire in ' || extract(day from expiration_date - current_date) || ' days.'
          end as reason
          
          
        from
          aws_route53_domain;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Connector:
- aws
Tags: {}
Severity: low
